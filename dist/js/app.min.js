"use strict";!function(){var n=null,o=null,j=null,a=null,c=null,s=null,d=null;function l(){this.myRequest="http://localhost:3000/toDoTask",this.jsonObject={title:"",text:"",id:0}}document.addEventListener("DOMContentLoaded",function(e){function t(){for(var e=new l;j.firstChild;)j.removeChild(j.firstChild);e.GET("")}n=document.querySelector(".toDoNew__input"),o=document.querySelector(".toDoNew__textarea"),j=document.querySelector(".toDoItems"),a=document.querySelector(".toDoNew"),c=document.querySelector(".toDoSearch"),s=document.querySelector(".toDoSearch__input"),d=document.querySelector(".toDoWorks__btn"),t(),a.addEventListener("submit",function(e){e.preventDefault(),console.log("Pobrane dane z DOM: ",n.value," Text: ",o.value);var t=new l;if(t.validate(n.value,o.value)){for(;j.firstChild;)j.removeChild(j.firstChild);t.POST(),n.value="",o.value=""}else alert("Wpisz poprawne dane!")}),c.addEventListener("submit",function(e){e.preventDefault();var t=new l;if(console.log("Szukaj: ",s.value),""!==s.value){for(;j.firstChild;)j.removeChild(j.firstChild);t.GET("?q=".concat(s.value))}}),d.addEventListener("click",t),document.addEventListener("click",function(e){"task__clean-btn"===e.target.className&&(console.log("Usuwam zadanie: ",e.srcElement.id),(new l).DELETE("/".concat(e.srcElement.id)),t())})}),l.prototype.validate=function(e,t){return console.log("uruchomiona  Validate"),!(""===e&""===t)&&(this.jsonObject.title=e,this.jsonObject.text=t,!0)},l.prototype.addTask=function(e){this.jsonObject.title=e.title,this.jsonObject.text=e.text,this.jsonObject.id=e.id;var t=document.createElement("article");t.classList.add("task"),t.id=this.jsonObject.id;var n=document.createElement("div");n.classList.add("task__header");var o=document.createElement("div");o.classList.add("task__text");var a=document.createElement("div");a.classList.add("task__clear-both"),t.appendChild(n),t.appendChild(a),t.appendChild(o),j.appendChild(t);var c=document.createElement("div");c.classList.add("task__title");var s=document.createElement("h3"),d=document.createTextNode(this.jsonObject.title);s.appendChild(d),c.appendChild(s);var l=document.createElement("div");l.classList.add("task__clean");var r=document.createElement("button");r.classList.add("task__clean-btn"),r.id=this.jsonObject.id;var i=document.createTextNode("Usu≈Ñ");r.appendChild(i),l.appendChild(r);var u=new Date,h=document.createElement("div");h.classList.add("task__date");var p=document.createTextNode("".concat(u.getDate(),".").concat(u.getMonth()+1,".").concat(u.getFullYear()));h.appendChild(p);var m=document.createElement("div");m.classList.add("task__time");var v=document.createTextNode("".concat(u.getHours(),":").concat(u.getMinutes()));m.appendChild(v);var f=document.createElement("P"),E=document.createTextNode(this.jsonObject.text);f.appendChild(E),n.appendChild(c),n.appendChild(l),n.appendChild(m),n.appendChild(h),o.appendChild(f),console.log("Finish task - AddTask")},l.prototype.POST=function(){var t=this;fetch(this.myRequest,{method:"post",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify(this.jsonObject)}).then(function(e){return e.json()}).then(function(e){console.log("We send:"),console.log(e),t.GET("")})},l.prototype.DELETE=function(e){fetch(this.myRequest+e,{method:"delete"}).then(function(e){return e.ok?e.json():Promise.reject(e)}).then(function(e){console.log("Respond GET: ",e)}).catch(function(e){404===e.status?console.log("Error: 404 Not Found"):400===e.status?console.log("Error: 400 Bad Request! Incorrect request ups..."):console.log("Other error: ",e.status)})},l.prototype.GET=function(e){var n=this;fetch(this.myRequest+e).then(function(e){return e.ok?e.json():Promise.reject(e)}).then(function(e){console.log("Respond GET: ",e);for(var t=0;t<e.length;t++)n.addTask(e[t])}).catch(function(e){404===e.status?console.log("Error: 404 Not Found"):400===e.status?console.log("Error: 400 Bad Request! Incorrect request ups..."):console.log("Other error: ",e.status)})}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJ0aXRsZSIsInRleHQiLCJ0b0RvSXRlbXMiLCJhZGRGb3JtIiwic2VhcmNoRm9ybSIsInNlYXJjaFdvcmQiLCJyZWZyZXNoQnV0dG9uIiwiY29uc29sZSIsInRoaXMiLCJkZWxldGVUYXNrIiwicmVmcmVzaCIsImlkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZSIsInJlZnJlc2hUYXNrIiwiVGFzayIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsIkdFVCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwibG9nIiwidmFsdWUiLCJuZXdUYXNrIiwidmFsaWRhdGUiLCJhbGVydCIsInNlYXJjaFRhc2siLCJlbGVtZW50Iiwic3JjRWxlbWVudCIsIkRFTEVURSIsImNvbmNhdCIsInByb3RvdHlwZSIsImpzb25PYmplY3QiLCJhZGRUYXNrIiwiZWxlbSIsInRhc2siLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiaGVhZGVyIiwiYWRkIiwidGV4dEFyZWEiLCJjbGVhckJvdGgiLCJhcHBlbmRDaGlsZCIsImhlYWQzIiwidGl0bGVOb2RlIiwiY2xlYW4iLCJjbGVhbl9idG4iLCJkZWxldGVOb2RlIiwiY3JlYXRlVGV4dE5vZGUiLCJkYXRlIiwiZGVsZXRlVGV4dCIsIm5ld0RhdGUiLCJnZXREYXRlIiwiZ2V0TW9udGgiLCJnZXRGdWxsWWVhciIsImdldEhvdXJzIiwiZ2V0TWludXRlcyIsInBhcmFncmFoIiwiRGF0ZSIsInRpbWUiLCJ0aW1lTm9kZSIsIm5vZGVUZXh0IiwiUE9TVCIsIl90aGlzIiwiSlNPTiIsInN0cmluZ2lmeSIsInRoZW4iLCJyZXMiLCJteVJlcXVlc3QiLCJudW1iZXIiLCJib2R5IiwibWV0aG9kIiwicmVzcCIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJlcnJvciIsInN0YXR1cyIsImh0dHBSZXF1ZXN0IiwiX3RoaXMyIiwiaSIsImxlbmd0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QUEsRUFBQUMsT0FDSUgsUUFBUUMsSUFBT0osd0JBQ3pCLE1BQUFLLEVBQUFDLE9BRUN6RSxRQUFRZ0IsSUFBQSxvREFZTmhCLFFBQVFnQixJQUFJLGdCQUFpQndELEVBQU1DLFdBdk50RCIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIlxyXG5cclxuICAgIGxldCB0aXRsZSA9IG51bGw7XHJcbiAgICBsZXQgdGV4dCA9IG51bGw7XHJcbiAgICBsZXQgdG9Eb0l0ZW1zID0gbnVsbDtcclxuICAgIGxldCBhZGRGb3JtID0gbnVsbDtcclxuICAgIGxldCBzZWFyY2hGb3JtID0gbnVsbDtcclxuICAgIGxldCBzZWFyY2hXb3JkID0gbnVsbDtcclxuICAgIGxldCByZWZyZXNoQnV0dG9uID0gbnVsbDtcclxuXHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9Eb05ld19faW5wdXRcIik7XHJcbiAgICAgICAgdGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9Eb05ld19fdGV4dGFyZWFcIik7XHJcbiAgICAgICAgdG9Eb0l0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b0RvSXRlbXNcIik7XHJcbiAgICAgICAgYWRkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9Eb05ld1wiKTtcclxuICAgICAgICBzZWFyY2hGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b0RvU2VhcmNoXCIpO1xyXG4gICAgICAgIHNlYXJjaFdvcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvRG9TZWFyY2hfX2lucHV0XCIpO1xyXG4gICAgICAgIHJlZnJlc2hCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvRG9Xb3Jrc19fYnRuXCIpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiByZWZyZXNoKCkge1xyXG4gICAgICAgICAgICBsZXQgcmVmcmVzaFRhc2sgPSBuZXcgVGFzaygpO1xyXG4gICAgICAgICAgICB3aGlsZSAodG9Eb0l0ZW1zLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHRvRG9JdGVtcy5yZW1vdmVDaGlsZCh0b0RvSXRlbXMuZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJlZnJlc2hUYXNrLkdFVChcIlwiKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJlZnJlc2goKTtcclxuXHJcbiAgICAgICAgYWRkRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBvYnJhbmUgZGFuZSB6IERPTTogXCIsIHRpdGxlLnZhbHVlLCBcIiBUZXh0OiBcIiwgdGV4dC52YWx1ZSk7XHJcbiAgICAgICAgICAgIGxldCBuZXdUYXNrID0gbmV3IFRhc2soKTtcclxuICAgICAgICAgICAgaWYgKG5ld1Rhc2sudmFsaWRhdGUodGl0bGUudmFsdWUsIHRleHQudmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAodG9Eb0l0ZW1zLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0b0RvSXRlbXMucmVtb3ZlQ2hpbGQodG9Eb0l0ZW1zLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIG5ld1Rhc2suUE9TVCgpO1xyXG4gICAgICAgICAgICAgICAgdGl0bGUudmFsdWUgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgdGV4dC52YWx1ZSA9IFwiXCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydChcIldwaXN6IHBvcHJhd25lIGRhbmUhXCIpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBzZWFyY2hGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGxldCBzZWFyY2hUYXNrID0gbmV3IFRhc2soKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJTenVrYWo6IFwiLCBzZWFyY2hXb3JkLnZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKHNlYXJjaFdvcmQudmFsdWUgIT09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlICh0b0RvSXRlbXMuZmlyc3RDaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvRG9JdGVtcy5yZW1vdmVDaGlsZCh0b0RvSXRlbXMuZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgc2VhcmNoVGFzay5HRVQoYD9xPSR7c2VhcmNoV29yZC52YWx1ZX1gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJlZnJlc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHJlZnJlc2gpO1xyXG5cclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZWxlbWVudCl7XHJcbiAgICAgICAgICAgIGlmKGVsZW1lbnQudGFyZ2V0LmNsYXNzTmFtZSA9PT0gXCJ0YXNrX19jbGVhbi1idG5cIil7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVzdXdhbSB6YWRhbmllOiBcIixlbGVtZW50LnNyY0VsZW1lbnQuaWQpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGRlbGV0ZVRhc2sgPSBuZXcgVGFzaygpO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlVGFzay5ERUxFVEUoYC8ke2VsZW1lbnQuc3JjRWxlbWVudC5pZH1gKTtcclxuICAgICAgICAgICAgICAgIHJlZnJlc2goKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBUYXNrKCkge1xyXG4gICAgICAgIHRoaXMubXlSZXF1ZXN0ID0gXCJodHRwOi8vbG9jYWxob3N0OjMwMDAvdG9Eb1Rhc2tcIjtcclxuICAgICAgICB0aGlzLmpzb25PYmplY3QgPSB7XHJcbiAgICAgICAgICAgIHRpdGxlOiBcIlwiLFxyXG4gICAgICAgICAgICB0ZXh0OiBcIlwiLFxyXG4gICAgICAgICAgICBpZDogMFxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgVGFzay5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAodGl0bGUsIHRleHQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcInVydWNob21pb25hICBWYWxpZGF0ZVwiKTtcclxuICAgICAgICBpZiAodGl0bGUgPT09IFwiXCIgJiB0ZXh0ID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdC50aXRsZSA9IHRpdGxlO1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdC50ZXh0ID0gdGV4dDtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBUYXNrLnByb3RvdHlwZS5hZGRUYXNrID0gZnVuY3Rpb24gKGVsZW0pIHtcclxuICAgICAgICB0aGlzLmpzb25PYmplY3QudGl0bGUgPSBlbGVtLnRpdGxlO1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdC50ZXh0ID0gZWxlbS50ZXh0O1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdC5pZCA9IGVsZW0uaWQ7XHJcblxyXG4gICAgICAgIC8vLy8vL3Rhc2sgLy8vLy8vLy8vLy9cclxuICAgICAgICBsZXQgdGFzayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhcnRpY2xlXCIpO1xyXG4gICAgICAgIHRhc2suY2xhc3NMaXN0LmFkZChcInRhc2tcIik7XHJcbiAgICAgICAgdGFzay5pZCA9IHRoaXMuanNvbk9iamVjdC5pZDtcclxuICAgICAgICBsZXQgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICBoZWFkZXIuY2xhc3NMaXN0LmFkZChcInRhc2tfX2hlYWRlclwiKTtcclxuICAgICAgICBsZXQgdGV4dEFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHRleHRBcmVhLmNsYXNzTGlzdC5hZGQoXCJ0YXNrX190ZXh0XCIpO1xyXG4gICAgICAgIGxldCBjbGVhckJvdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIGNsZWFyQm90aC5jbGFzc0xpc3QuYWRkKFwidGFza19fY2xlYXItYm90aFwiKTtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRhc2spO1xyXG4gICAgICAgIHRhc2suYXBwZW5kQ2hpbGQoaGVhZGVyKTtcclxuICAgICAgICB0YXNrLmFwcGVuZENoaWxkKGNsZWFyQm90aCk7XHJcbiAgICAgICAgdGFzay5hcHBlbmRDaGlsZCh0ZXh0QXJlYSk7XHJcbiAgICAgICAgdG9Eb0l0ZW1zLmFwcGVuZENoaWxkKHRhc2spO1xyXG5cclxuICAgICAgICAvLy8vLy8gdGFzayB0aXRsZSAvLy8vLy8vLy8vL1xyXG4gICAgICAgIGxldCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgdGl0bGUuY2xhc3NMaXN0LmFkZChcInRhc2tfX3RpdGxlXCIpO1xyXG4gICAgICAgIGxldCBoZWFkMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoM1wiKTtcclxuICAgICAgICBsZXQgdGl0bGVOb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5qc29uT2JqZWN0LnRpdGxlKTtcclxuICAgICAgICBoZWFkMy5hcHBlbmRDaGlsZCh0aXRsZU5vZGUpO1xyXG4gICAgICAgIHRpdGxlLmFwcGVuZENoaWxkKGhlYWQzKTtcclxuXHJcbiAgICAgICAgLy8vLy9idXR0b24gZGVsZXRlIC8vLy9cclxuICAgICAgICBsZXQgZGVsZXRlVGV4dCA9IFwiVXN1xYRcIjtcclxuICAgICAgICBsZXQgY2xlYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIGNsZWFuLmNsYXNzTGlzdC5hZGQoXCJ0YXNrX19jbGVhblwiKTtcclxuICAgICAgICBsZXQgY2xlYW5fYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcclxuICAgICAgICBjbGVhbl9idG4uY2xhc3NMaXN0LmFkZChcInRhc2tfX2NsZWFuLWJ0blwiKTtcclxuICAgICAgICBjbGVhbl9idG4uaWQgPSB0aGlzLmpzb25PYmplY3QuaWQ7XHJcbiAgICAgICAgbGV0IGRlbGV0ZU5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkZWxldGVUZXh0KTtcclxuICAgICAgICBjbGVhbl9idG4uYXBwZW5kQ2hpbGQoZGVsZXRlTm9kZSk7XHJcbiAgICAgICAgY2xlYW4uYXBwZW5kQ2hpbGQoY2xlYW5fYnRuKTtcclxuXHJcbiAgICAgICAgLy8vLy8vdGFzayAgRGF0ZSBhbmQgdGltZSAvLy8vLy8vLy8vLy9cclxuICAgICAgICBsZXQgbmV3RGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgbGV0IGRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIGRhdGUuY2xhc3NMaXN0LmFkZChcInRhc2tfX2RhdGVcIik7XHJcbiAgICAgICAgbGV0IGRhdGVOb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoYCR7bmV3RGF0ZS5nZXREYXRlKCl9LiR7bmV3RGF0ZS5nZXRNb250aCgpICsgMX0uJHtuZXdEYXRlLmdldEZ1bGxZZWFyKCl9YCk7XHJcbiAgICAgICAgZGF0ZS5hcHBlbmRDaGlsZChkYXRlTm9kZSk7XHJcblxyXG4gICAgICAgIGxldCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICB0aW1lLmNsYXNzTGlzdC5hZGQoXCJ0YXNrX190aW1lXCIpO1xyXG4gICAgICAgIGxldCB0aW1lTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGAke25ld0RhdGUuZ2V0SG91cnMoKX06JHtuZXdEYXRlLmdldE1pbnV0ZXMoKX1gKTtcclxuICAgICAgICB0aW1lLmFwcGVuZENoaWxkKHRpbWVOb2RlKTtcclxuXHJcbiAgICAgICAgLy8vLy8vIHRhc2sgdGV4dCAvLy8vLy8vLy8vL1xyXG4gICAgICAgIGxldCBwYXJhZ3JhaCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJQXCIpO1xyXG4gICAgICAgIGxldCBub2RlVGV4dCA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHRoaXMuanNvbk9iamVjdC50ZXh0KTtcclxuICAgICAgICBwYXJhZ3JhaC5hcHBlbmRDaGlsZChub2RlVGV4dCk7XHJcblxyXG5cclxuICAgICAgICAvLy8vLy8vIEFkZCBhbGwgdG8gVGFzayAvLy8vLy8vLy9cclxuICAgICAgICBoZWFkZXIuYXBwZW5kQ2hpbGQodGl0bGUpO1xyXG4gICAgICAgIGhlYWRlci5hcHBlbmRDaGlsZChjbGVhbik7XHJcbiAgICAgICAgaGVhZGVyLmFwcGVuZENoaWxkKHRpbWUpO1xyXG4gICAgICAgIGhlYWRlci5hcHBlbmRDaGlsZChkYXRlKTtcclxuICAgICAgICB0ZXh0QXJlYS5hcHBlbmRDaGlsZChwYXJhZ3JhaCk7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRmluaXNoIHRhc2sgLSBBZGRUYXNrXCIpO1xyXG4gICAgfTtcclxuICAgIFRhc2sucHJvdG90eXBlLlBPU1QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZmV0Y2godGhpcy5teVJlcXVlc3QsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgXCJDb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PVVURi04XCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodGhpcy5qc29uT2JqZWN0KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PlxyXG4gICAgICAgICAgICAgICAgcmVzLmpzb24oKSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiV2Ugc2VuZDpcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5HRVQoXCJcIik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFRhc2sucHJvdG90eXBlLkRFTEVURSA9IGZ1bmN0aW9uIChudW1iZXIpIHtcclxuICAgICAgICBmZXRjaCh0aGlzLm15UmVxdWVzdCArIG51bWJlcix7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJkZWxldGVcIlxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKHJlc3AgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3Aub2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcC5qc29uKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXNwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlc3BvbmQgR0VUOiBcIiwgcmVzcCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOiA0MDQgTm90IEZvdW5kXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvci5zdGF0dXMgPT09IDQwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6IDQwMCBCYWQgUmVxdWVzdCEgSW5jb3JyZWN0IHJlcXVlc3QgdXBzLi4uXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk90aGVyIGVycm9yOiBcIiwgZXJyb3Iuc3RhdHVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVGFzay5wcm90b3R5cGUuR0VUID0gZnVuY3Rpb24gKGh0dHBSZXF1ZXN0KSB7XHJcbiAgICAgICAgZmV0Y2godGhpcy5teVJlcXVlc3QgKyBodHRwUmVxdWVzdClcclxuICAgICAgICAgICAgLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzcC5vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwLmpzb24oKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlc3ApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXNwID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVzcG9uZCBHRVQ6IFwiLCByZXNwKTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkVGFzayhyZXNwW2ldKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOiA0MDQgTm90IEZvdW5kXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvci5zdGF0dXMgPT09IDQwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6IDQwMCBCYWQgUmVxdWVzdCEgSW5jb3JyZWN0IHJlcXVlc3QgdXBzLi4uXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk90aGVyIGVycm9yOiBcIiwgZXJyb3Iuc3RhdHVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59KCkpOyJdfQ==
