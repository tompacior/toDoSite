"use strict";!function(){var s=null,c=null,E=null,t=null,o=null,n=null,a=null;function d(){this.myRequest="http://localhost:3000/toDoTask",this.jsonObject={title:"",text:"",id:0,date:0,time:0}}document.addEventListener("DOMContentLoaded",function(){function e(){(new d).GET("")}s=document.querySelector(".toDoNew__input"),c=document.querySelector(".toDoNew__textarea"),E=document.querySelector(".toDoItems"),t=document.querySelector(".toDoNew"),o=document.querySelector(".toDoSearch"),n=document.querySelector(".toDoSearch__input"),a=document.querySelector(".toDoWorks__btn"),e(),t.addEventListener("submit",function(e){e.preventDefault(),console.log("Pobrane dane z DOM: ",s.value," Text: ",c.value);var t=new d,o=new Date,n="".concat(o.getDate(),".").concat(o.getMonth()+1,".").concat(o.getFullYear()),a="".concat(o.getHours(),":").concat(o.getMinutes());console.log(" Data: ",n),console.log("Time: ",a),t.validate(s.value,c.value,n,a)?(t.POST(),s.value="",c.value=""):alert("Wpisz poprawne dane!")}),o.addEventListener("submit",function(e){e.preventDefault();var t=new d;console.log("Szukaj: ",n.value),""!==n.value&&t.GET("?q=".concat(n.value))}),a.addEventListener("click",e),document.addEventListener("click",function(e){"task__clean-btn"===e.target.className&&(console.log("Usuwam zadanie: ",e.srcElement.id),(new d).DELETE("/".concat(e.srcElement.id)))})}),d.prototype.validate=function(e,t,o,n){return console.log("uruchomiona  Validate"),""!==e&&(this.jsonObject.title=e,this.jsonObject.text=t,this.jsonObject.date=o,this.jsonObject.time=n,!0)},d.prototype.addTask=function(e){this.jsonObject.title=e.title,this.jsonObject.text=e.text,this.jsonObject.id=e.id,this.jsonObject.date=e.date,this.jsonObject.time=e.time;var t=document.createElement("article");t.classList.add("task"),t.id=this.jsonObject.id;var o=document.createElement("div");o.classList.add("task__header");var n=document.createElement("div");n.classList.add("task__text");var a=document.createElement("div");a.classList.add("task__clear-both"),t.appendChild(o),t.appendChild(a),t.appendChild(n),E.appendChild(t);var s=document.createElement("div");s.classList.add("task__title");var c=document.createElement("h3"),d=document.createTextNode(this.jsonObject.title);c.appendChild(d),s.appendChild(c);var r=document.createElement("div");r.classList.add("task__clean");var l=document.createElement("button");l.classList.add("task__clean-btn"),l.id=this.jsonObject.id;var i=document.createTextNode("Usu≈Ñ");l.appendChild(i),r.appendChild(l);var u=document.createElement("div");u.classList.add("task__date");var h=document.createTextNode(this.jsonObject.date);u.appendChild(h);var m=document.createElement("div");m.classList.add("task__time");var p=document.createTextNode(this.jsonObject.time);m.appendChild(p);var v=document.createElement("P"),j=document.createTextNode(this.jsonObject.text);v.appendChild(j),o.appendChild(s),o.appendChild(r),o.appendChild(m),o.appendChild(u),n.appendChild(v),console.log("Finish task - AddTask")},d.prototype.POST=function(){var t=this;fetch(this.myRequest,{method:"post",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify(this.jsonObject)}).then(function(e){return e.ok?e.json():Promise.reject(e)}).then(function(e){console.log("We send:"),console.log(e),t.GET("")}).catch(function(e){404===e.status?console.log("Error: 404 Not Found"):400===e.status?console.log("Error: 400 Bad Request! Incorrect request ups..."):console.log("Other error: ",e.status)})},d.prototype.DELETE=function(e){var t=this;fetch(this.myRequest+e,{method:"delete"}).then(function(e){return e.ok?e.json():Promise.reject(e)}).then(function(e){console.log("Respond Delete: ",e),t.GET("")}).catch(function(e){404===e.status?console.log("Error: 404 Not Found"):400===e.status?console.log("Error: 400 Bad Request! Incorrect request ups..."):console.log("Other error: ",e.status)})},d.prototype.GET=function(e){var o=this;fetch(this.myRequest+e).then(function(e){return e.ok?e.json():Promise.reject(e)}).then(function(e){for(console.log("Respond GET: ",e);E.firstChild;)E.removeChild(E.firstChild);for(var t=0;t<e.length;t++)o.addTask(e[t])}).catch(function(e){404===e.status?console.log("Error: 404 Not Found"):400===e.status?console.log("Error: 400 Bad Request! Incorrect request ups..."):console.log("Other error: ",e.status)})}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJ0aXRsZSIsInRleHQiLCJ0b0RvSXRlbXMiLCJhZGRGb3JtIiwic2VhcmNoRm9ybSIsInNlYXJjaFdvcmQiLCJyZWZyZXNoQnV0dG9uIiwiVGFzayIsInRoaXMiLCJteVJlcXVlc3QiLCJqc29uT2JqZWN0IiwiZGF0ZSIsInRpbWUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJyZWZyZXNoVGFzayIsIkdFVCIsInJlZnJlc2giLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsImNvbnNvbGUiLCJsb2ciLCJ2YWx1ZSIsIm5ld1Rhc2siLCJuZXdEYXRlIiwiRGF0ZSIsImNvbmNhdCIsImdldERhdGUiLCJnZXRNb250aCIsImdldEZ1bGxZZWFyIiwiZ2V0SG91cnMiLCJnZXRNaW51dGVzIiwidmFsaWRhdGUiLCJQT1NUIiwiYWxlcnQiLCJzZWFyY2hUYXNrIiwiZWxlbWVudCIsImlkIiwiY2xhc3NOYW1lIiwiREVMRVRFIiwic3JjRWxlbWVudCIsInByb3RvdHlwZSIsImFkZFRhc2siLCJlbGVtIiwidGFzayIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJoZWFkZXIiLCJ0ZXh0QXJlYSIsImNsZWFyQm90aCIsImFwcGVuZENoaWxkIiwiaGVhZDMiLCJjcmVhdGVUZXh0Tm9kZSIsInRpdGxlTm9kZSIsImRlbGV0ZU5vZGUiLCJkZWxldGVUZXh0IiwiY2xlYW4iLCJjbGVhbl9idG4iLCJkYXRlTm9kZSIsInRpbWVOb2RlIiwicGFyYWdyYWgiLCJub2RlVGV4dCIsIl90aGlzIiwiZmV0Y2giLCJoZWFkZXJzIiwiQ29udGVudC10eXBlIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsImVycm9yIiwic3RhdHVzIiwibnVtYmVyIiwibWV0aG9kIiwicmVzcCIsIl90aGlzMiIsImh0dHBSZXF1ZXN0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Rk1tQyxVQUVBMUIsSUFBQSxTQUFBbUUsR0FBQSxJQUFBQyxFQUFBNUUsS0FDSGEsTUFBQUEsS0FBQVosVUFBWTBFLEdBQ2ZaLEtBQUEsU0FBQVUsR0FyQlQsT0FBQUEsRUFBQVIsR0FESlEsRUFBQVAsT0F5QnFCQyxRQUFVUSxPQUFBQSxLQUNyQlosS0FBSzlELFNBQUFBLEdBR1F3RSxJQURGUixRQUFJbkQsSUFBQSxnQkFBQTJELEdBQ0dQLEVBQVpXLFlBQ0duRixFQUFBb0YsWUFBQXBGLEVBQUFtRixZQUVOLElBQUEsSUFBQUUsRUFBQSxFQUFBQSxFQUFBTixFQUFBTyxPQUFBRCxJQUVDSCxFQUFBSCxRQUFRQSxFQUFBTSxNQWJObEUsTUFlR25CLFNBQUFBLEdBQ21CQSxNQUFab0YsRUFBQUEsT0FDYmpFLFFBQUFDLElBQUEsd0JBUTJCLE1BQWpCdUQsRUFBTUMsT0FSaEJ6RCxRQUFBQyxJQUFBLG9EQUNERCxRQUFvQjRELElBQUtPLGdCQUFhWCxFQUFBQyxXQS9OckQiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbihmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgXCJ1c2Ugc3RyaWN0XCJcclxuXHJcbiAgICBsZXQgdGl0bGUgPSBudWxsO1xyXG4gICAgbGV0IHRleHQgPSBudWxsO1xyXG4gICAgbGV0IHRvRG9JdGVtcyA9IG51bGw7XHJcbiAgICBsZXQgYWRkRm9ybSA9IG51bGw7XHJcbiAgICBsZXQgc2VhcmNoRm9ybSA9IG51bGw7XHJcbiAgICBsZXQgc2VhcmNoV29yZCA9IG51bGw7XHJcbiAgICBsZXQgcmVmcmVzaEJ1dHRvbiA9IG51bGw7XHJcblxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9Eb05ld19faW5wdXRcIik7XHJcbiAgICAgICAgdGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9Eb05ld19fdGV4dGFyZWFcIik7XHJcbiAgICAgICAgdG9Eb0l0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b0RvSXRlbXNcIik7XHJcbiAgICAgICAgYWRkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9Eb05ld1wiKTtcclxuICAgICAgICBzZWFyY2hGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b0RvU2VhcmNoXCIpO1xyXG4gICAgICAgIHNlYXJjaFdvcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvRG9TZWFyY2hfX2lucHV0XCIpO1xyXG4gICAgICAgIHJlZnJlc2hCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvRG9Xb3Jrc19fYnRuXCIpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiByZWZyZXNoKCkge1xyXG4gICAgICAgICAgICBsZXQgcmVmcmVzaFRhc2sgPSBuZXcgVGFzaygpO1xyXG4gICAgICAgICAgICByZWZyZXNoVGFzay5HRVQoXCJcIik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZWZyZXNoKCk7XHJcblxyXG4gICAgICAgIGFkZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJQb2JyYW5lIGRhbmUgeiBET006IFwiLCB0aXRsZS52YWx1ZSwgXCIgVGV4dDogXCIsIHRleHQudmFsdWUpO1xyXG4gICAgICAgICAgICBsZXQgbmV3VGFzayA9IG5ldyBUYXNrKCk7XHJcbiAgICAgICAgICAgIGxldCBuZXdEYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgbGV0IGRhdGUgPSBgJHtuZXdEYXRlLmdldERhdGUoKX0uJHtuZXdEYXRlLmdldE1vbnRoKCkgKyAxfS4ke25ld0RhdGUuZ2V0RnVsbFllYXIoKX1gO1xyXG4gICAgICAgICAgICBsZXQgdGltZSA9IGAke25ld0RhdGUuZ2V0SG91cnMoKX06JHtuZXdEYXRlLmdldE1pbnV0ZXMoKX1gO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIiBEYXRhOiBcIiwgZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGltZTogXCIsIHRpbWUpO1xyXG4gICAgICAgICAgICBpZiAobmV3VGFzay52YWxpZGF0ZSh0aXRsZS52YWx1ZSwgdGV4dC52YWx1ZSwgZGF0ZSwgdGltZSkpIHtcclxuICAgICAgICAgICAgICAgIG5ld1Rhc2suUE9TVCgpO1xyXG4gICAgICAgICAgICAgICAgdGl0bGUudmFsdWUgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgdGV4dC52YWx1ZSA9IFwiXCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydChcIldwaXN6IHBvcHJhd25lIGRhbmUhXCIpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBzZWFyY2hGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGxldCBzZWFyY2hUYXNrID0gbmV3IFRhc2soKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJTenVrYWo6IFwiLCBzZWFyY2hXb3JkLnZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKHNlYXJjaFdvcmQudmFsdWUgIT09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgIHNlYXJjaFRhc2suR0VUKGA/cT0ke3NlYXJjaFdvcmQudmFsdWV9YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZWZyZXNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCByZWZyZXNoKTtcclxuXHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGVsZW1lbnQpe1xyXG4gICAgICAgICAgICBpZihlbGVtZW50LnRhcmdldC5jbGFzc05hbWUgPT09IFwidGFza19fY2xlYW4tYnRuXCIpe1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJVc3V3YW0gemFkYW5pZTogXCIsZWxlbWVudC5zcmNFbGVtZW50LmlkKTtcclxuICAgICAgICAgICAgICAgIGxldCBkZWxldGVUYXNrID0gbmV3IFRhc2soKTtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZVRhc2suREVMRVRFKGAvJHtlbGVtZW50LnNyY0VsZW1lbnQuaWR9YCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgZnVuY3Rpb24gVGFzaygpIHtcclxuICAgICAgICB0aGlzLm15UmVxdWVzdCA9IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwL3RvRG9UYXNrXCI7XHJcbiAgICAgICAgdGhpcy5qc29uT2JqZWN0ID0ge1xyXG4gICAgICAgICAgICB0aXRsZTogXCJcIixcclxuICAgICAgICAgICAgdGV4dDogXCJcIixcclxuICAgICAgICAgICAgaWQ6IDAsXHJcbiAgICAgICAgICAgIGRhdGU6IDAsXHJcbiAgICAgICAgICAgIHRpbWU6IDBcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIFRhc2sucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKHRpdGxlLCB0ZXh0LCBkYXRlLCB0aW1lKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJ1cnVjaG9taW9uYSAgVmFsaWRhdGVcIik7XHJcbiAgICAgICAgaWYgKHRpdGxlID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdC50aXRsZSA9IHRpdGxlO1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdC50ZXh0ID0gdGV4dDtcclxuICAgICAgICB0aGlzLmpzb25PYmplY3QuZGF0ZSA9IGRhdGU7XHJcbiAgICAgICAgdGhpcy5qc29uT2JqZWN0LnRpbWUgPSB0aW1lO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIFRhc2sucHJvdG90eXBlLmFkZFRhc2sgPSBmdW5jdGlvbiAoZWxlbSkge1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdC50aXRsZSA9IGVsZW0udGl0bGU7XHJcbiAgICAgICAgdGhpcy5qc29uT2JqZWN0LnRleHQgPSBlbGVtLnRleHQ7XHJcbiAgICAgICAgdGhpcy5qc29uT2JqZWN0LmlkID0gZWxlbS5pZDtcclxuICAgICAgICB0aGlzLmpzb25PYmplY3QuZGF0ZSA9IGVsZW0uZGF0ZTtcclxuICAgICAgICB0aGlzLmpzb25PYmplY3QudGltZSA9IGVsZW0udGltZTtcclxuXHJcbiAgICAgICAgLy8vLy8vdGFzayAvLy8vLy8vLy8vL1xyXG4gICAgICAgIGxldCB0YXNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFydGljbGVcIik7XHJcbiAgICAgICAgdGFzay5jbGFzc0xpc3QuYWRkKFwidGFza1wiKTtcclxuICAgICAgICB0YXNrLmlkID0gdGhpcy5qc29uT2JqZWN0LmlkO1xyXG4gICAgICAgIGxldCBoZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIGhlYWRlci5jbGFzc0xpc3QuYWRkKFwidGFza19faGVhZGVyXCIpO1xyXG4gICAgICAgIGxldCB0ZXh0QXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgdGV4dEFyZWEuY2xhc3NMaXN0LmFkZChcInRhc2tfX3RleHRcIik7XHJcbiAgICAgICAgbGV0IGNsZWFyQm90aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgY2xlYXJCb3RoLmNsYXNzTGlzdC5hZGQoXCJ0YXNrX19jbGVhci1ib3RoXCIpO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2codGFzayk7XHJcbiAgICAgICAgdGFzay5hcHBlbmRDaGlsZChoZWFkZXIpO1xyXG4gICAgICAgIHRhc2suYXBwZW5kQ2hpbGQoY2xlYXJCb3RoKTtcclxuICAgICAgICB0YXNrLmFwcGVuZENoaWxkKHRleHRBcmVhKTtcclxuICAgICAgICB0b0RvSXRlbXMuYXBwZW5kQ2hpbGQodGFzayk7XHJcblxyXG4gICAgICAgIC8vLy8vLyB0YXNrIHRpdGxlIC8vLy8vLy8vLy8vXHJcbiAgICAgICAgbGV0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKFwidGFza19fdGl0bGVcIik7XHJcbiAgICAgICAgbGV0IGhlYWQzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgzXCIpO1xyXG4gICAgICAgIGxldCB0aXRsZU5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLmpzb25PYmplY3QudGl0bGUpO1xyXG4gICAgICAgIGhlYWQzLmFwcGVuZENoaWxkKHRpdGxlTm9kZSk7XHJcbiAgICAgICAgdGl0bGUuYXBwZW5kQ2hpbGQoaGVhZDMpO1xyXG5cclxuICAgICAgICAvLy8vL2J1dHRvbiBkZWxldGUgLy8vL1xyXG4gICAgICAgIGxldCBkZWxldGVUZXh0ID0gXCJVc3XFhFwiO1xyXG4gICAgICAgIGxldCBjbGVhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgY2xlYW4uY2xhc3NMaXN0LmFkZChcInRhc2tfX2NsZWFuXCIpO1xyXG4gICAgICAgIGxldCBjbGVhbl9idG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gICAgICAgIGNsZWFuX2J0bi5jbGFzc0xpc3QuYWRkKFwidGFza19fY2xlYW4tYnRuXCIpO1xyXG4gICAgICAgIGNsZWFuX2J0bi5pZCA9IHRoaXMuanNvbk9iamVjdC5pZDtcclxuICAgICAgICBsZXQgZGVsZXRlTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGRlbGV0ZVRleHQpO1xyXG4gICAgICAgIGNsZWFuX2J0bi5hcHBlbmRDaGlsZChkZWxldGVOb2RlKTtcclxuICAgICAgICBjbGVhbi5hcHBlbmRDaGlsZChjbGVhbl9idG4pO1xyXG5cclxuICAgICAgICAvLy8vLy90YXNrICBEYXRlIGFuZCB0aW1lIC8vLy8vLy8vLy8vL1xyXG4gICAgICAgIGxldCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICBkYXRlLmNsYXNzTGlzdC5hZGQoXCJ0YXNrX19kYXRlXCIpO1xyXG4gICAgICAgIGxldCBkYXRlTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHRoaXMuanNvbk9iamVjdC5kYXRlKTtcclxuICAgICAgICBkYXRlLmFwcGVuZENoaWxkKGRhdGVOb2RlKTtcclxuXHJcbiAgICAgICAgbGV0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHRpbWUuY2xhc3NMaXN0LmFkZChcInRhc2tfX3RpbWVcIik7XHJcbiAgICAgICAgbGV0IHRpbWVOb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5qc29uT2JqZWN0LnRpbWUpO1xyXG4gICAgICAgIHRpbWUuYXBwZW5kQ2hpbGQodGltZU5vZGUpO1xyXG5cclxuICAgICAgICAvLy8vLy8gdGFzayB0ZXh0IC8vLy8vLy8vLy8vXHJcbiAgICAgICAgbGV0IHBhcmFncmFoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIlBcIik7XHJcbiAgICAgICAgbGV0IG5vZGVUZXh0ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5qc29uT2JqZWN0LnRleHQpO1xyXG4gICAgICAgIHBhcmFncmFoLmFwcGVuZENoaWxkKG5vZGVUZXh0KTtcclxuXHJcblxyXG4gICAgICAgIC8vLy8vLy8gQWRkIGFsbCB0byBUYXNrIC8vLy8vLy8vL1xyXG4gICAgICAgIGhlYWRlci5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcbiAgICAgICAgaGVhZGVyLmFwcGVuZENoaWxkKGNsZWFuKTtcclxuICAgICAgICBoZWFkZXIuYXBwZW5kQ2hpbGQodGltZSk7XHJcbiAgICAgICAgaGVhZGVyLmFwcGVuZENoaWxkKGRhdGUpO1xyXG4gICAgICAgIHRleHRBcmVhLmFwcGVuZENoaWxkKHBhcmFncmFoKTtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJGaW5pc2ggdGFzayAtIEFkZFRhc2tcIik7XHJcbiAgICB9O1xyXG4gICAgVGFzay5wcm90b3R5cGUuUE9TVCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmZXRjaCh0aGlzLm15UmVxdWVzdCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICBcIkNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9VVRGLThcIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh0aGlzLmpzb25PYmplY3QpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PntcclxuICAgICAgICAgICAgICAgIGlmKHJlcy5vayl7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXMpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiV2Ugc2VuZDpcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5HRVQoXCJcIik7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOiA0MDQgTm90IEZvdW5kXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvci5zdGF0dXMgPT09IDQwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6IDQwMCBCYWQgUmVxdWVzdCEgSW5jb3JyZWN0IHJlcXVlc3QgdXBzLi4uXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk90aGVyIGVycm9yOiBcIiwgZXJyb3Iuc3RhdHVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVGFzay5wcm90b3R5cGUuREVMRVRFID0gZnVuY3Rpb24gKG51bWJlcikge1xyXG4gICAgICAgIGZldGNoKHRoaXMubXlSZXF1ZXN0ICsgbnVtYmVyLHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcImRlbGV0ZVwiXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzcC5vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwLmpzb24oKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlc3ApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXNwID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVzcG9uZCBEZWxldGU6IFwiLCByZXNwKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuR0VUKFwiXCIpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNDA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvcjogNDA0IE5vdCBGb3VuZFwiKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOiA0MDAgQmFkIFJlcXVlc3QhIEluY29ycmVjdCByZXF1ZXN0IHVwcy4uLlwiKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJPdGhlciBlcnJvcjogXCIsIGVycm9yLnN0YXR1cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFRhc2sucHJvdG90eXBlLkdFVCA9IGZ1bmN0aW9uIChodHRwUmVxdWVzdCkge1xyXG4gICAgICAgIGZldGNoKHRoaXMubXlSZXF1ZXN0ICsgaHR0cFJlcXVlc3QpXHJcbiAgICAgICAgICAgIC50aGVuKHJlc3AgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3Aub2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcC5qc29uKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXNwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlc3BvbmQgR0VUOiBcIiwgcmVzcCk7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAodG9Eb0l0ZW1zLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0b0RvSXRlbXMucmVtb3ZlQ2hpbGQodG9Eb0l0ZW1zLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkVGFzayhyZXNwW2ldKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOiA0MDQgTm90IEZvdW5kXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvci5zdGF0dXMgPT09IDQwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6IDQwMCBCYWQgUmVxdWVzdCEgSW5jb3JyZWN0IHJlcXVlc3QgdXBzLi4uXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk90aGVyIGVycm9yOiBcIiwgZXJyb3Iuc3RhdHVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59KCkpOyJdfQ==
