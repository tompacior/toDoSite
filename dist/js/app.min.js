"use strict";!function(){var s=null,c=null,f=null,o=null,n=null,a=null,d=null;function i(){this.myRequest="http://localhost:3000/toDoTask",this.jsonObject={title:"",text:"",id:0,date:0,time:0}}document.addEventListener("DOMContentLoaded",function(e){function t(){for(var e=new i;f.firstChild;)f.removeChild(f.firstChild);e.GET("")}s=document.querySelector(".toDoNew__input"),c=document.querySelector(".toDoNew__textarea"),f=document.querySelector(".toDoItems"),o=document.querySelector(".toDoNew"),n=document.querySelector(".toDoSearch"),a=document.querySelector(".toDoSearch__input"),d=document.querySelector(".toDoWorks__btn"),t(),o.addEventListener("submit",function(e){e.preventDefault(),console.log("Pobrane dane z DOM: ",s.value," Text: ",c.value);var t=new i,o=new Date,n="".concat(o.getDate(),".").concat(o.getMonth()+1,".").concat(o.getFullYear()),a="".concat(o.getHours(),":").concat(o.getMinutes());if(console.log(" Data: ",n),console.log("Time: ",a),t.validate(s.value,c.value,n,a)){for(;f.firstChild;)f.removeChild(f.firstChild);t.POST(),s.value="",c.value=""}else alert("Wpisz poprawne dane!")}),n.addEventListener("submit",function(e){e.preventDefault();var t=new i;if(console.log("Szukaj: ",a.value),""!==a.value){for(;f.firstChild;)f.removeChild(f.firstChild);t.GET("?q=".concat(a.value))}}),d.addEventListener("click",t),document.addEventListener("click",function(e){"task__clean-btn"===e.target.className&&(console.log("Usuwam zadanie: ",e.srcElement.id),(new i).DELETE("/".concat(e.srcElement.id)),t())})}),i.prototype.validate=function(e,t,o,n){return console.log("uruchomiona  Validate"),!(""===e&""===t)&&(this.jsonObject.title=e,this.jsonObject.text=t,this.jsonObject.date=o,this.jsonObject.time=n,!0)},i.prototype.addTask=function(e){this.jsonObject.title=e.title,this.jsonObject.text=e.text,this.jsonObject.id=e.id,this.jsonObject.date=e.date,this.jsonObject.time=e.time;var t=document.createElement("article");t.classList.add("task"),t.id=this.jsonObject.id;var o=document.createElement("div");o.classList.add("task__header");var n=document.createElement("div");n.classList.add("task__text");var a=document.createElement("div");a.classList.add("task__clear-both"),t.appendChild(o),t.appendChild(a),t.appendChild(n),f.appendChild(t);var s=document.createElement("div");s.classList.add("task__title");var c=document.createElement("h3"),d=document.createTextNode(this.jsonObject.title);c.appendChild(d),s.appendChild(c);var i=document.createElement("div");i.classList.add("task__clean");var l=document.createElement("button");l.classList.add("task__clean-btn"),l.id=this.jsonObject.id;var r=document.createTextNode("Usu≈Ñ");l.appendChild(r),i.appendChild(l);var u=document.createElement("div");u.classList.add("task__date");var h=document.createTextNode(this.jsonObject.date);u.appendChild(h);var m=document.createElement("div");m.classList.add("task__time");var p=document.createTextNode(this.jsonObject.time);m.appendChild(p);var v=document.createElement("P"),j=document.createTextNode(this.jsonObject.text);v.appendChild(j),o.appendChild(s),o.appendChild(i),o.appendChild(m),o.appendChild(u),n.appendChild(v),console.log("Finish task - AddTask")},i.prototype.POST=function(){var t=this;fetch(this.myRequest,{method:"post",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify(this.jsonObject)}).then(function(e){return e.json()}).then(function(e){console.log("We send:"),console.log(e),t.GET("")})},i.prototype.DELETE=function(e){fetch(this.myRequest+e,{method:"delete"}).then(function(e){return e.ok?e.json():Promise.reject(e)}).then(function(e){console.log("Respond GET: ",e)}).catch(function(e){404===e.status?console.log("Error: 404 Not Found"):400===e.status?console.log("Error: 400 Bad Request! Incorrect request ups..."):console.log("Other error: ",e.status)})},i.prototype.GET=function(e){var o=this;fetch(this.myRequest+e).then(function(e){return e.ok?e.json():Promise.reject(e)}).then(function(e){console.log("Respond GET: ",e);for(var t=0;t<e.length;t++)o.addTask(e[t])}).catch(function(e){404===e.status?console.log("Error: 404 Not Found"):400===e.status?console.log("Error: 400 Bad Request! Incorrect request ups..."):console.log("Other error: ",e.status)})}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJ0aXRsZSIsInRleHQiLCJ0b0RvSXRlbXMiLCJhZGRGb3JtIiwic2VhcmNoRm9ybSIsInNlYXJjaFdvcmQiLCJyZWZyZXNoQnV0dG9uIiwiY29uc29sZSIsInRoaXMiLCJkZWxldGVUYXNrIiwicmVmcmVzaCIsImlkIiwiZGF0ZSIsInRpbWUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJlIiwicmVmcmVzaFRhc2siLCJUYXNrIiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwiR0VUIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJsb2ciLCJ2YWx1ZSIsIkRhdGUiLCJjb25jYXQiLCJuZXdEYXRlIiwiZ2V0RGF0ZSIsImdldE1vbnRoIiwiZ2V0RnVsbFllYXIiLCJuZXdUYXNrIiwiZ2V0SG91cnMiLCJnZXRNaW51dGVzIiwidmFsaWRhdGUiLCJhbGVydCIsInNlYXJjaFRhc2siLCJlbGVtZW50Iiwic3JjRWxlbWVudCIsIkRFTEVURSIsInByb3RvdHlwZSIsIm15UmVxdWVzdCIsImpzb25PYmplY3QiLCJhZGRUYXNrIiwiZWxlbSIsInRhc2siLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiaGVhZGVyIiwidGV4dEFyZWEiLCJjbGVhckJvdGgiLCJoZWFkMyIsInRpdGxlTm9kZSIsImNsZWFuIiwiYXBwZW5kQ2hpbGQiLCJjbGVhbl9idG4iLCJkZWxldGVOb2RlIiwiY3JlYXRlVGV4dE5vZGUiLCJkYXRlTm9kZSIsImRlbGV0ZVRleHQiLCJub2RlVGV4dCIsInRpbWVOb2RlIiwicGFyYWdyYWgiLCJQT1NUIiwiX3RoaXMiLCJKU09OIiwic3RyaW5naWZ5IiwidGhlbiIsInJlcyIsIm51bWJlciIsImJvZHkiLCJtZXRob2QiLCJyZXNwIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsImVycm9yIiwic3RhdHVzIiwiaHR0cFJlcXVlc3QiLCJfdGhpczIi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QUF1RCxFQUFBQyxXQU1EL0QsRUFBQXdCLFVBQVV1QyxJQUFOLFNBQXNCQyxHQUFBLElBQUFDLEVBQUEzRSxLQUN0QkQsTUFBQUEsS0FBQW9DLFVBQVl1QyxHQUNUWixLQUFJVSxTQUFBQSxHQUNDdkQsT0FBSWtELEVBQUFDLEdBQ1RELEVBQUFFLE9BRU5DLFFBQUFDLE9BQUFKLEtBWUpMLEtBQUssU0FBQUssR0FUZHBFLFFBQXFCa0IsSUFBQSxnQkFBQWtELEdBQXVCLElBQUEsSUFBQVMsRUFBQSxFQUFBQSxFQUFBVCxFQUFBVSxPQUFBRCxJQVk1QkQsRUFBS3RDLFFBQVE4QixFQUFLUyxNQXBCbEI3RSxNQVlXLFNBQUF5RSxHQUNSLE1BQUFBLEVBQUFDLE9BQ0lILFFBQVFDLElBQU9KLHdCQUN6QixNQUFBSyxFQUFBQyxPQUVDMUUsUUFBUWtCLElBQUEsb0RBWU5sQixRQUFRa0IsSUFBSSxnQkFBaUJ1RCxFQUFNQyxXQWpPdEQiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbihmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgXCJ1c2Ugc3RyaWN0XCJcclxuXHJcbiAgICBsZXQgdGl0bGUgPSBudWxsO1xyXG4gICAgbGV0IHRleHQgPSBudWxsO1xyXG4gICAgbGV0IHRvRG9JdGVtcyA9IG51bGw7XHJcbiAgICBsZXQgYWRkRm9ybSA9IG51bGw7XHJcbiAgICBsZXQgc2VhcmNoRm9ybSA9IG51bGw7XHJcbiAgICBsZXQgc2VhcmNoV29yZCA9IG51bGw7XHJcbiAgICBsZXQgcmVmcmVzaEJ1dHRvbiA9IG51bGw7XHJcblxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvRG9OZXdfX2lucHV0XCIpO1xyXG4gICAgICAgIHRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvRG9OZXdfX3RleHRhcmVhXCIpO1xyXG4gICAgICAgIHRvRG9JdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9Eb0l0ZW1zXCIpO1xyXG4gICAgICAgIGFkZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvRG9OZXdcIik7XHJcbiAgICAgICAgc2VhcmNoRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9Eb1NlYXJjaFwiKTtcclxuICAgICAgICBzZWFyY2hXb3JkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b0RvU2VhcmNoX19pbnB1dFwiKTtcclxuICAgICAgICByZWZyZXNoQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b0RvV29ya3NfX2J0blwiKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgbGV0IHJlZnJlc2hUYXNrID0gbmV3IFRhc2soKTtcclxuICAgICAgICAgICAgd2hpbGUgKHRvRG9JdGVtcy5maXJzdENoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICB0b0RvSXRlbXMucmVtb3ZlQ2hpbGQodG9Eb0l0ZW1zLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZWZyZXNoVGFzay5HRVQoXCJcIik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZWZyZXNoKCk7XHJcblxyXG4gICAgICAgIGFkZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJQb2JyYW5lIGRhbmUgeiBET006IFwiLCB0aXRsZS52YWx1ZSwgXCIgVGV4dDogXCIsIHRleHQudmFsdWUpO1xyXG4gICAgICAgICAgICBsZXQgbmV3VGFzayA9IG5ldyBUYXNrKCk7XHJcbiAgICAgICAgICAgIGxldCBuZXdEYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgbGV0IGRhdGUgPSBgJHtuZXdEYXRlLmdldERhdGUoKX0uJHtuZXdEYXRlLmdldE1vbnRoKCkgKyAxfS4ke25ld0RhdGUuZ2V0RnVsbFllYXIoKX1gO1xyXG4gICAgICAgICAgICBsZXQgdGltZSA9IGAke25ld0RhdGUuZ2V0SG91cnMoKX06JHtuZXdEYXRlLmdldE1pbnV0ZXMoKX1gO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIiBEYXRhOiBcIiwgZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGltZTogXCIsIHRpbWUpO1xyXG4gICAgICAgICAgICBpZiAobmV3VGFzay52YWxpZGF0ZSh0aXRsZS52YWx1ZSwgdGV4dC52YWx1ZSwgZGF0ZSwgdGltZSkpIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlICh0b0RvSXRlbXMuZmlyc3RDaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvRG9JdGVtcy5yZW1vdmVDaGlsZCh0b0RvSXRlbXMuZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgbmV3VGFzay5QT1NUKCk7XHJcbiAgICAgICAgICAgICAgICB0aXRsZS52YWx1ZSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICB0ZXh0LnZhbHVlID0gXCJcIjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwiV3Bpc3ogcG9wcmF3bmUgZGFuZSFcIik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHNlYXJjaEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgbGV0IHNlYXJjaFRhc2sgPSBuZXcgVGFzaygpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlN6dWthajogXCIsIHNlYXJjaFdvcmQudmFsdWUpO1xyXG4gICAgICAgICAgICBpZiAoc2VhcmNoV29yZC52YWx1ZSAhPT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKHRvRG9JdGVtcy5maXJzdENoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9Eb0l0ZW1zLnJlbW92ZUNoaWxkKHRvRG9JdGVtcy5maXJzdENoaWxkKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBzZWFyY2hUYXNrLkdFVChgP3E9JHtzZWFyY2hXb3JkLnZhbHVlfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmVmcmVzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgcmVmcmVzaCk7XHJcblxyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlbGVtZW50KXtcclxuICAgICAgICAgICAgaWYoZWxlbWVudC50YXJnZXQuY2xhc3NOYW1lID09PSBcInRhc2tfX2NsZWFuLWJ0blwiKXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVXN1d2FtIHphZGFuaWU6IFwiLGVsZW1lbnQuc3JjRWxlbWVudC5pZCk7XHJcbiAgICAgICAgICAgICAgICBsZXQgZGVsZXRlVGFzayA9IG5ldyBUYXNrKCk7XHJcbiAgICAgICAgICAgICAgICBkZWxldGVUYXNrLkRFTEVURShgLyR7ZWxlbWVudC5zcmNFbGVtZW50LmlkfWApO1xyXG4gICAgICAgICAgICAgICAgcmVmcmVzaCgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICAgIGZ1bmN0aW9uIFRhc2soKSB7XHJcbiAgICAgICAgdGhpcy5teVJlcXVlc3QgPSBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC90b0RvVGFza1wiO1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdCA9IHtcclxuICAgICAgICAgICAgdGl0bGU6IFwiXCIsXHJcbiAgICAgICAgICAgIHRleHQ6IFwiXCIsXHJcbiAgICAgICAgICAgIGlkOiAwLFxyXG4gICAgICAgICAgICBkYXRlOiAwLFxyXG4gICAgICAgICAgICB0aW1lOiAwXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBUYXNrLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICh0aXRsZSwgdGV4dCwgZGF0ZSwgdGltZSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwidXJ1Y2hvbWlvbmEgIFZhbGlkYXRlXCIpO1xyXG4gICAgICAgIGlmICh0aXRsZSA9PT0gXCJcIiAmIHRleHQgPT09IFwiXCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5qc29uT2JqZWN0LnRpdGxlID0gdGl0bGU7XHJcbiAgICAgICAgdGhpcy5qc29uT2JqZWN0LnRleHQgPSB0ZXh0O1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdC5kYXRlID0gZGF0ZTtcclxuICAgICAgICB0aGlzLmpzb25PYmplY3QudGltZSA9IHRpbWU7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgVGFzay5wcm90b3R5cGUuYWRkVGFzayA9IGZ1bmN0aW9uIChlbGVtKSB7XHJcbiAgICAgICAgdGhpcy5qc29uT2JqZWN0LnRpdGxlID0gZWxlbS50aXRsZTtcclxuICAgICAgICB0aGlzLmpzb25PYmplY3QudGV4dCA9IGVsZW0udGV4dDtcclxuICAgICAgICB0aGlzLmpzb25PYmplY3QuaWQgPSBlbGVtLmlkO1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdC5kYXRlID0gZWxlbS5kYXRlO1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdC50aW1lID0gZWxlbS50aW1lO1xyXG5cclxuICAgICAgICAvLy8vLy90YXNrIC8vLy8vLy8vLy8vXHJcbiAgICAgICAgbGV0IHRhc2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYXJ0aWNsZVwiKTtcclxuICAgICAgICB0YXNrLmNsYXNzTGlzdC5hZGQoXCJ0YXNrXCIpO1xyXG4gICAgICAgIHRhc2suaWQgPSB0aGlzLmpzb25PYmplY3QuaWQ7XHJcbiAgICAgICAgbGV0IGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgaGVhZGVyLmNsYXNzTGlzdC5hZGQoXCJ0YXNrX19oZWFkZXJcIik7XHJcbiAgICAgICAgbGV0IHRleHRBcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICB0ZXh0QXJlYS5jbGFzc0xpc3QuYWRkKFwidGFza19fdGV4dFwiKTtcclxuICAgICAgICBsZXQgY2xlYXJCb3RoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICBjbGVhckJvdGguY2xhc3NMaXN0LmFkZChcInRhc2tfX2NsZWFyLWJvdGhcIik7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0YXNrKTtcclxuICAgICAgICB0YXNrLmFwcGVuZENoaWxkKGhlYWRlcik7XHJcbiAgICAgICAgdGFzay5hcHBlbmRDaGlsZChjbGVhckJvdGgpO1xyXG4gICAgICAgIHRhc2suYXBwZW5kQ2hpbGQodGV4dEFyZWEpO1xyXG4gICAgICAgIHRvRG9JdGVtcy5hcHBlbmRDaGlsZCh0YXNrKTtcclxuXHJcbiAgICAgICAgLy8vLy8vIHRhc2sgdGl0bGUgLy8vLy8vLy8vLy9cclxuICAgICAgICBsZXQgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHRpdGxlLmNsYXNzTGlzdC5hZGQoXCJ0YXNrX190aXRsZVwiKTtcclxuICAgICAgICBsZXQgaGVhZDMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDNcIik7XHJcbiAgICAgICAgbGV0IHRpdGxlTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHRoaXMuanNvbk9iamVjdC50aXRsZSk7XHJcbiAgICAgICAgaGVhZDMuYXBwZW5kQ2hpbGQodGl0bGVOb2RlKTtcclxuICAgICAgICB0aXRsZS5hcHBlbmRDaGlsZChoZWFkMyk7XHJcblxyXG4gICAgICAgIC8vLy8vYnV0dG9uIGRlbGV0ZSAvLy8vXHJcbiAgICAgICAgbGV0IGRlbGV0ZVRleHQgPSBcIlVzdcWEXCI7XHJcbiAgICAgICAgbGV0IGNsZWFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICBjbGVhbi5jbGFzc0xpc3QuYWRkKFwidGFza19fY2xlYW5cIik7XHJcbiAgICAgICAgbGV0IGNsZWFuX2J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcbiAgICAgICAgY2xlYW5fYnRuLmNsYXNzTGlzdC5hZGQoXCJ0YXNrX19jbGVhbi1idG5cIik7XHJcbiAgICAgICAgY2xlYW5fYnRuLmlkID0gdGhpcy5qc29uT2JqZWN0LmlkO1xyXG4gICAgICAgIGxldCBkZWxldGVOb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZGVsZXRlVGV4dCk7XHJcbiAgICAgICAgY2xlYW5fYnRuLmFwcGVuZENoaWxkKGRlbGV0ZU5vZGUpO1xyXG4gICAgICAgIGNsZWFuLmFwcGVuZENoaWxkKGNsZWFuX2J0bik7XHJcblxyXG4gICAgICAgIC8vLy8vL3Rhc2sgIERhdGUgYW5kIHRpbWUgLy8vLy8vLy8vLy8vXHJcbiAgICAgICAgbGV0IGRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIGRhdGUuY2xhc3NMaXN0LmFkZChcInRhc2tfX2RhdGVcIik7XHJcbiAgICAgICAgbGV0IGRhdGVOb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5qc29uT2JqZWN0LmRhdGUpO1xyXG4gICAgICAgIGRhdGUuYXBwZW5kQ2hpbGQoZGF0ZU5vZGUpO1xyXG5cclxuICAgICAgICBsZXQgdGltZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgdGltZS5jbGFzc0xpc3QuYWRkKFwidGFza19fdGltZVwiKTtcclxuICAgICAgICBsZXQgdGltZU5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLmpzb25PYmplY3QudGltZSk7XHJcbiAgICAgICAgdGltZS5hcHBlbmRDaGlsZCh0aW1lTm9kZSk7XHJcblxyXG4gICAgICAgIC8vLy8vLyB0YXNrIHRleHQgLy8vLy8vLy8vLy9cclxuICAgICAgICBsZXQgcGFyYWdyYWggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiUFwiKTtcclxuICAgICAgICBsZXQgbm9kZVRleHQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLmpzb25PYmplY3QudGV4dCk7XHJcbiAgICAgICAgcGFyYWdyYWguYXBwZW5kQ2hpbGQobm9kZVRleHQpO1xyXG5cclxuXHJcbiAgICAgICAgLy8vLy8vLyBBZGQgYWxsIHRvIFRhc2sgLy8vLy8vLy8vXHJcbiAgICAgICAgaGVhZGVyLmFwcGVuZENoaWxkKHRpdGxlKTtcclxuICAgICAgICBoZWFkZXIuYXBwZW5kQ2hpbGQoY2xlYW4pO1xyXG4gICAgICAgIGhlYWRlci5hcHBlbmRDaGlsZCh0aW1lKTtcclxuICAgICAgICBoZWFkZXIuYXBwZW5kQ2hpbGQoZGF0ZSk7XHJcbiAgICAgICAgdGV4dEFyZWEuYXBwZW5kQ2hpbGQocGFyYWdyYWgpO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhcIkZpbmlzaCB0YXNrIC0gQWRkVGFza1wiKTtcclxuICAgIH07XHJcbiAgICBUYXNrLnByb3RvdHlwZS5QT1NUID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGZldGNoKHRoaXMubXlSZXF1ZXN0LCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgIFwiQ29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD1VVEYtOFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHRoaXMuanNvbk9iamVjdClcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT5cclxuICAgICAgICAgICAgICAgIHJlcy5qc29uKCkpXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIldlIHNlbmQ6XCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuR0VUKFwiXCIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBUYXNrLnByb3RvdHlwZS5ERUxFVEUgPSBmdW5jdGlvbiAobnVtYmVyKSB7XHJcbiAgICAgICAgZmV0Y2godGhpcy5teVJlcXVlc3QgKyBudW1iZXIse1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiZGVsZXRlXCJcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXNwID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXNwLm9rKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3AuanNvbigpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzcCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKHJlc3AgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZXNwb25kIEdFVDogXCIsIHJlc3ApO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNDA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvcjogNDA0IE5vdCBGb3VuZFwiKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOiA0MDAgQmFkIFJlcXVlc3QhIEluY29ycmVjdCByZXF1ZXN0IHVwcy4uLlwiKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJPdGhlciBlcnJvcjogXCIsIGVycm9yLnN0YXR1cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFRhc2sucHJvdG90eXBlLkdFVCA9IGZ1bmN0aW9uIChodHRwUmVxdWVzdCkge1xyXG4gICAgICAgIGZldGNoKHRoaXMubXlSZXF1ZXN0ICsgaHR0cFJlcXVlc3QpXHJcbiAgICAgICAgICAgIC50aGVuKHJlc3AgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3Aub2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcC5qc29uKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXNwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlc3BvbmQgR0VUOiBcIiwgcmVzcCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3AubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFRhc2socmVzcFtpXSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNDA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvcjogNDA0IE5vdCBGb3VuZFwiKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOiA0MDAgQmFkIFJlcXVlc3QhIEluY29ycmVjdCByZXF1ZXN0IHVwcy4uLlwiKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJPdGhlciBlcnJvcjogXCIsIGVycm9yLnN0YXR1cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfTtcclxufSgpKTsiXX0=
