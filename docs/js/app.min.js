"use strict";!function(){var a=null,c=null,E=null,t=null,o=null,n=null,s=null;function r(){this.myRequest="https://my-json-server.typicode.com/tompacior/fakeServer/toDoTask",this.jsonObject={title:"",text:"",id:0,date:0,time:0}}document.addEventListener("DOMContentLoaded",function(){function e(){(new r).GET("")}a=document.querySelector(".toDoNew__input"),c=document.querySelector(".toDoNew__textarea"),E=document.querySelector(".toDoItems"),t=document.querySelector(".toDoNew"),o=document.querySelector(".toDoSearch"),n=document.querySelector(".toDoSearch__input"),s=document.querySelector(".toDoWorks__btn"),e(),t.addEventListener("submit",function(e){e.preventDefault(),console.log("Pobrane dane z DOM: ",a.value," Text: ",c.value);var t=new r,o=new Date,n="".concat(o.getDate(),".").concat(o.getMonth()+1,".").concat(o.getFullYear()),s="".concat(o.getHours(),":").concat(o.getMinutes());console.log(" Data: ",n),console.log("Time: ",s),t.validate(a.value,c.value,n,s)?(t.POST(),a.value="",c.value=""):alert("Wpisz poprawne dane!")}),o.addEventListener("submit",function(e){e.preventDefault();var t=new r;console.log("Szukaj: ",n.value),""!==n.value&&t.GET("?q=".concat(n.value))}),s.addEventListener("click",e),document.addEventListener("click",function(e){"task__clean-btn"===e.target.className&&(console.log("Usuwam zadanie: ",e.srcElement.id),(new r).DELETE("/".concat(e.srcElement.id)))})}),r.prototype.validate=function(e,t,o,n){return console.log("uruchomiona  Validate"),""!==e&&(this.jsonObject.title=e,this.jsonObject.text=t,this.jsonObject.date=o,this.jsonObject.time=n,!0)},r.prototype.addTask=function(e){this.jsonObject.title=e.title,this.jsonObject.text=e.text,this.jsonObject.id=e.id,this.jsonObject.date=e.date,this.jsonObject.time=e.time;var t=document.createElement("article");t.classList.add("task"),t.id=this.jsonObject.id;var o=document.createElement("div");o.classList.add("task__header");var n=document.createElement("div");n.classList.add("task__text");var s=document.createElement("div");s.classList.add("task__clear-both"),t.appendChild(o),t.appendChild(s),t.appendChild(n),E.appendChild(t);var a=document.createElement("div");a.classList.add("task__title");var c=document.createElement("h3"),r=document.createTextNode(this.jsonObject.title);c.appendChild(r),a.appendChild(c);var d=document.createElement("div");d.classList.add("task__clean");var l=document.createElement("button");l.classList.add("task__clean-btn"),l.id=this.jsonObject.id;var i=document.createTextNode("Usu≈Ñ");l.appendChild(i),d.appendChild(l);var u=document.createElement("div");u.classList.add("task__date");var h=document.createTextNode(this.jsonObject.date);u.appendChild(h);var m=document.createElement("div");m.classList.add("task__time");var p=document.createTextNode(this.jsonObject.time);m.appendChild(p);var v=document.createElement("P"),j=document.createTextNode(this.jsonObject.text);v.appendChild(j),o.appendChild(a),o.appendChild(d),o.appendChild(m),o.appendChild(u),n.appendChild(v),console.log("Finish task - AddTask")},r.prototype.POST=function(){var t=this;fetch(this.myRequest,{method:"post",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify(this.jsonObject)}).then(function(e){return e.ok?e.json():Promise.reject(e)}).then(function(e){console.log("We send:"),console.log(e),t.GET("")}).catch(function(e){404===e.status?console.log("Error: 404 Not Found"):400===e.status?console.log("Error: 400 Bad Request! Incorrect request ups..."):console.log("Other error: ",e.status)})},r.prototype.DELETE=function(e){var t=this;fetch(this.myRequest+e,{method:"delete"}).then(function(e){return e.ok?e.json():Promise.reject(e)}).then(function(e){console.log("Respond Delete: ",e),t.GET("")}).catch(function(e){404===e.status?console.log("Error: 404 Not Found"):400===e.status?console.log("Error: 400 Bad Request! Incorrect request ups..."):console.log("Other error: ",e.status)})},r.prototype.GET=function(e){var o=this;fetch(this.myRequest+e).then(function(e){return e.ok?e.json():Promise.reject(e)}).then(function(e){for(console.log("Respond GET: ",e);E.firstChild;)E.removeChild(E.firstChild);for(var t=0;t<e.length;t++)o.addTask(e[t])}).catch(function(e){404===e.status?console.log("Error: 404 Not Found"):400===e.status?console.log("Error: 400 Bad Request! Incorrect request ups..."):console.log("Other error: ",e.status)})}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJ0aXRsZSIsInRleHQiLCJ0b0RvSXRlbXMiLCJhZGRGb3JtIiwic2VhcmNoRm9ybSIsInNlYXJjaFdvcmQiLCJyZWZyZXNoQnV0dG9uIiwiVGFzayIsInRoaXMiLCJteVJlcXVlc3QiLCJqc29uT2JqZWN0IiwiaWQiLCJ0aW1lIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicmVmcmVzaFRhc2siLCJHRVQiLCJyZWZyZXNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJjb25zb2xlIiwibG9nIiwidmFsdWUiLCJuZXdUYXNrIiwibmV3RGF0ZSIsIkRhdGUiLCJkYXRlIiwiY29uY2F0IiwiZ2V0RGF0ZSIsImdldE1vbnRoIiwiZ2V0RnVsbFllYXIiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiLCJ2YWxpZGF0ZSIsIlBPU1QiLCJhbGVydCIsInNlYXJjaFRhc2siLCJlbGVtZW50IiwiY2xhc3NOYW1lIiwiREVMRVRFIiwic3JjRWxlbWVudCIsInByb3RvdHlwZSIsImFkZFRhc2siLCJlbGVtIiwidGFzayIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJoZWFkZXIiLCJ0ZXh0QXJlYSIsImNsZWFyQm90aCIsImFwcGVuZENoaWxkIiwidGl0bGVOb2RlIiwiY3JlYXRlVGV4dE5vZGUiLCJoZWFkMyIsImNsZWFuX2J0biIsImRlbGV0ZU5vZGUiLCJkZWxldGVUZXh0IiwiY2xlYW4iLCJ0aW1lTm9kZSIsInBhcmFncmFoIiwibm9kZVRleHQiLCJfdGhpcyIsImZldGNoIiwibWV0aG9kIiwiQ29udGVudC10eXBlIiwiYm9keSIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0IiwiZXJyb3IiLCJzdGF0dXMiLCJudW1iZXIiLCJfdGhpczIiLCJyZXNwIiwiaHR0cFJlcXVlc3QiLCJfdGhpczMiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJsZW5ndGgiLCJpIl0sIm1hcHBpbmdzIjoiY0FDQyxXQUlHLElBQUlBLEVBQVEsS0FDUkMsRUFBTyxLQUNQQyxFQUFZLEtBQ1pDLEVBQVUsS0FDVkMsRUFBYSxLQUNiQyxFQUFhLEtBQ2JDLEVBQWdCLEtBbURmLFNBTkRDLElBM0NKQyxLQUFBQyxVQUFBLG9FQXVESUQsS0FBS0UsV0FBYSxDQUZiSCxNQUFPLEdBQ1BFLEtBQUwsR0FJSUUsR0FBSSxFQUhIRCxLQUFBQSxFQUNJRSxLQURTLEdBdERsQlosU0FBUWEsaUJBQVNDLG1CQUFjLFdBUzNCLFNBQUlDLEtBQ0osSUFBQVIsR0FDSFMsSUFBQSxJQVZHaEIsRUFBR2EsU0FBU0MsY0FBYyxtQkFDOUJaLEVBQVNXLFNBQVdDLGNBQVIsc0JBQ1pYLEVBQVVVLFNBQVNDLGNBQWMsY0FDakNWLEVBQWFTLFNBQVNDLGNBQWMsWUFDcENULEVBQWFRLFNBQVNDLGNBQWMsZUFDcENSLEVBQWdCTyxTQUFTQyxjQUFjLHNCQUF2Q1IsRUFBZ0JPLFNBQVNDLGNBQWMsbUJBS3RDRyxJQUdEZCxFQUFRZSxpQkFBaUIsU0FBVSxTQUFVQyxHQUNuQ0MsRUFBQUEsaUJBQ05DLFFBQVlDLElBQUEsdUJBQThCQyxFQUExQ0EsTUFBaUQsVUFBZ0JBLEVBQWpFQSxPQUNJQyxJQUFBQSxFQUFjakIsSUFBbEJBLEVBQ0lrQixFQUFjQyxJQUFsQkEsS0FDUUMsRUFBQSxHQUFBQyxPQUFBSCxFQUFhSSxVQUFiLEtBQUFELE9BQUFILEVBQUFLLFdBQW1DQSxFQUFuQyxLQUFBRixPQUFtQ0UsRUFBbkNDLGVBQ0FuQixFQUFBLEdBQUFnQixPQUFBSCxFQUFhTyxXQUFiLEtBQUFKLE9BQUFILEVBQUFRLGNBQ1JaLFFBQVlDLElBQUEsVUFBWkssR0FDQU4sUUFBWUMsSUFBQSxTQUFaVixHQUNJWSxFQUFRVSxTQUFTbEMsRUFBTXVCLE1BQU90QixFQUFLc0IsTUFBT0ksRUFBTWYsSUFBaERZLEVBQVFVLE9BQ0FDLEVBQVJaLE1BQUEsR0FDTUEsRUFBTkEsTUFBQSxJQUVHYSxNQUFBLDBCQUVOaEMsRUFBQWMsaUJBQUEsU0FBQSxTQUFBQyxHQWZMQSxFQUFBQyxpQkFrQkFoQixJQUFXYyxFQUFBQSxJQUFpQlgsRUFDbEJhLFFBQUFBLElBQUFBLFdBQU5mLEVBQUFrQixPQUNBLEtBQUljLEVBQWlCOUIsT0FDYmUsRUFBSU4sSUFBSk0sTUFBQUEsT0FBZ0JqQixFQUF4QmtCLFVBRUljLEVBQUFuQixpQkFBcUJiLFFBQVdrQixHQUx4Q1YsU0FBQUssaUJBQUEsUUFBQSxTQUFBb0IsR0FRd0NyQixvQkFBeENYLEVBQWNZLE9BQUFBLFlBRUxBLFFBQUFBLElBQUFBLG1CQUEwQm9CLEVBQVNBLFdBQVEzQixLQUM5QjRCLElBQWZoQyxHQUNhaUMsT0FBSmxCLElBQUFBLE9BQVJnQixFQUErQkEsV0FBUUcsVUFjM0NkLEVBQUFBLFVBSmNPLFNBQUEsU0FBQWxDLEVBQUFDLEVBQUEwQixFQUFBZixHQUFsQixPQUtJQSxRQUFNVSxJQUFBLHlCQUxWLEtBQUF0QixJQU9IUSxLQUFBRSxXQUFBVixNQUFBQSxFQU9HUSxLQUFLRSxXQUFXVCxLQUFPQSxFQU50QnlDLEtBQUFBLFdBQVVSLEtBQVdQLEVBQ3RCTixLQUFRQyxXQUFJVixLQUFBQSxHQVFMLElBTkhMLEVBQUFtQyxVQUFBQyxRQUFBLFNBQUFDLEdBQ0hwQyxLQUFBRSxXQUFBVixNQUFBNEMsRUFBQTVDLE1BU0RRLEtBQUtFLFdBQVdULEtBQU8yQyxFQUFLM0MsS0FUM0JPLEtBQUFFLFdBQUFDLEdBQUFpQyxFQUFBakMsR0FDREgsS0FBS0UsV0FBV1YsS0FBUUEsRUFBeEIyQixLQUNBbkIsS0FBS0UsV0FBTEUsS0FBQWdDLEVBQUFoQyxLQUdBLElBQU9pQyxFQUFQaEMsU0FBQWlDLGNBQUEsV0FUSkQsRUFBQUUsVUFBQUMsSUFBQSxRQXFCSUgsRUFBS2xDLEdBQUtILEtBQUtFLFdBQVdDLEdBVnpCK0IsSUFBQUEsRUFBVUMsU0FBVUcsY0FBZ0IsT0FDckNHLEVBQUt2QyxVQUFMc0MsSUFBd0JKLGdCQUN4QixJQUFLbEMsRUFBV1QsU0FBWUEsY0FBNUIsT0FDQWlELEVBQUt4QyxVQUFnQmtDLElBQUtqQyxjQUMxQixJQUFLRCxFQUFMRyxTQUE0QmMsY0FBNUIsT0FDQXdCLEVBQUt6QyxVQUFrQmtDLElBQUtoQyxvQkFHeEJpQyxFQUFJTyxZQUFZTixHQUNoQkQsRUFBQ0UsWUFBY0ksR0FDZk4sRUFBSk8sWUFBZTFDLEdBQ1h1QyxFQUFTcEMsWUFBU2lDLEdBR3RCSSxJQUFRbEQsRUFBQytDLFNBQWNELGNBQXZCLE9BQ0lLLEVBQUFBLFVBQVl0QyxJQUFRLGVBQ3hCc0MsSUFBQUEsRUFBVUosU0FBY0QsY0FBQSxNQVdwQk8sRUFBWXhDLFNBQVN5QyxlQUFlOUMsS0FBS0UsV0FBV1YsT0FUcER1RCxFQUFDSCxZQUFZSCxHQUNiakQsRUFBQ29ELFlBQVlELEdBYWpCLElBUkluRCxFQUFRYSxTQUFTaUMsY0FBYyxPQUNuQzlDLEVBQU0rQyxVQUFjQyxJQUFBLGVBQ2hCTyxJQUFBQSxFQUFnQjFDLFNBQUNpQyxjQUFyQixVQUNJTyxFQUFTTixVQUFXQyxJQUFDTSxtQkFDekJDLEVBQU1ILEdBQVlDLEtBQUFBLFdBQWxCMUMsR0FDQVgsSUFBTW9ELEVBQVlHLFNBRWxCRCxlQUNpQixRQU9qQkUsRUFBVUosWUFBWUssR0FQbEJDLEVBQUFBLFlBQWFGLEdBR2JBLElBQUFBLEVBQVMzQyxTQUFXaUMsY0FBUixPQUNoQlUsRUFBU1QsVUFBVEMsSUFBQSxjQUNBUSxJQUFBQSxFQUFlM0MsU0FBS0gsZUFBcEJGLEtBQUFFLFdBQUFpQixNQUNJOEIsRUFBQUEsWUFBYTVDLEdBRWpCOEMsSUFBTVAsRUFBQUEsU0FBWUksY0FFbEIsT0FPQTVDLEVBQUttQyxVQUFVQyxJQUFJLGNBTmZyQixJQUFJaUMsRUFBVy9DLFNBQUNpQyxlQUFwQnRDLEtBQUFFLFdBQUFFLE1BQ0lBLEVBQUNtQyxZQUFjYSxHQUlmaEQsSUFBSWlELEVBQVdoRCxTQUFDaUMsY0FBcEIsS0FDS0MsRUFBY2xDLFNBQUF5QyxlQUFuQjlDLEtBQUFFLFdBQUFULE1BQ0kyRCxFQUFRUixZQUFZRSxHQUtwQlEsRUFBQUEsWUFBbUI5RCxHQUN2QjZELEVBQVNULFlBQVlVLEdBTXJCYixFQUFPRyxZQUFZeEMsR0FGbkJxQyxFQUFPRyxZQUFZcEQsR0FDbkJpRCxFQUFPRyxZQUFQUyxHQUVBWixRQUFPRyxJQUFBQSwwQkFHUC9CLEVBQUFBLFVBQVljLEtBQUEsV0FBQSxJQUFBNEIsRUFBQXZELEtBbEVoQndELE1BQUF4RCxLQUFBQyxVQUFBLENBc0VRd0QsT0FBUSxPQUZYdkIsUUFBTCxDQUFrQ3dCLGVBQUEsbUNBQ3hCQyxLQUFLMUQsS0FBQUEsVUFBV0QsS0FBQUUsY0FFWDBELEtBQUUsU0FBQUMsR0FDTCxPQUFBQSxFQUFBQyxHQUhjRCxFQUFBRSxPQU9OQyxRQUFBQyxPQUFBSixLQUdERCxLQUFBLFNBQUFDLEdBQ0lHLFFBQVFDLElBQUFBLFlBQ2xCcEQsUUFBQUMsSUFBQStDLEdBS0ROLEVBQUsvQyxJQUFJLE1BdEZyQixNQW1GYyxTQUFBMEQsR0FDRixNQUFZQSxFQUFBQyxPQUNBTixRQUFaL0MsSUFBQSx3QkFNNEIsTUFBakJvRCxFQUFNQyxPQUxqQnRELFFBQUFDLElBQUEsb0RBR1VxRCxRQUFXckQsSUFBSyxnQkFBQW9ELEVBQUFDLFdBSXpCcEUsRUFGTW1DLFVBRUFGLE9BQUEsU0FBQW9DLEdBQUEsSUFBQUMsRUFBQXJFLEtBQ0hhLE1BQUFBLEtBQUFaLFVBQVltRSxFQUFpQkYsQ0FDaENULE9BQUEsV0EzQmJHLEtBQUEsU0FBQVUsR0FtQ1ksT0FBSUEsRUFBS1IsR0FMR1EsRUFBQVAsT0FRREMsUUFBUUMsT0FBT0ssS0FKeEJWLEtBQUEsU0FBQVUsR0FDT1IsUUFBSWhELElBQUEsbUJBQUF3RCxHQUNGQSxFQUFLUCxJQUFMLE1BVlBsRCxNQVlPbUQsU0FBQUEsR0FDVixNQUFBRSxFQUFBQyxPQUVDdEQsUUFBUUMsSUFBQSx3QkFDVixNQUFZb0QsRUFBQUMsT0FPUnRELFFBQVFDLElBQUksb0RBSmJELFFBQUFxRCxJQUFLLGdCQUFJQSxFQUFBQyxXQUlSdEQsRUFBQUEsVUFBQUwsSUFBWSxTQUFBK0QsR0FBQSxJQUFBQyxFQUFBeEUsS0FEVHdELE1BRUF4RCxLQUFBQyxVQUFBc0UsR0FDSDFELEtBQVFDLFNBQUFBLEdBQ1gsT0FBQXdELEVBQUFSLEdBckJUUSxFQUFBUCxPQThCbUJDLFFBQVFDLE9BQU9LLEtBRzdCVixLQUFLLFNBQUFVLEdBTk9SLElBRk43RCxRQUFMYSxJQUFpQnlELGdCQUNiRCxHQUNXNUUsRUFBQStFLFlBQ0dWLEVBQVpXLFlBQUFoRixFQUFBK0UsWUFFT1QsSUFBQUEsSUFBUUMsRUFBUixFQUFlSyxFQUF0QkEsRUFBQUssT0FBQUMsSUFDSEosRUFBQXJDLFFBQUFtQyxFQUFBTSxNQWRNLE1BeUJKLFNBQUFWLEdBUDBCLE1BQXRCeEUsRUFBVStFLE9BQ0hDLFFBQUFBLElBQVloRix3QkFDekIsTUFBQXdFLEVBQUFDLE9BU0d0RCxRQUFRQyxJQUFJLG9EQUVaRCxRQUFRQyxJQUFJLGdCQUFpQm9ELEVBQU1DLFdBek90RCIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIlxyXG5cclxuICAgIGxldCB0aXRsZSA9IG51bGw7XHJcbiAgICBsZXQgdGV4dCA9IG51bGw7XHJcbiAgICBsZXQgdG9Eb0l0ZW1zID0gbnVsbDtcclxuICAgIGxldCBhZGRGb3JtID0gbnVsbDtcclxuICAgIGxldCBzZWFyY2hGb3JtID0gbnVsbDtcclxuICAgIGxldCBzZWFyY2hXb3JkID0gbnVsbDtcclxuICAgIGxldCByZWZyZXNoQnV0dG9uID0gbnVsbDtcclxuXHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b0RvTmV3X19pbnB1dFwiKTtcclxuICAgICAgICB0ZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b0RvTmV3X190ZXh0YXJlYVwiKTtcclxuICAgICAgICB0b0RvSXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvRG9JdGVtc1wiKTtcclxuICAgICAgICBhZGRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b0RvTmV3XCIpO1xyXG4gICAgICAgIHNlYXJjaEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvRG9TZWFyY2hcIik7XHJcbiAgICAgICAgc2VhcmNoV29yZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9Eb1NlYXJjaF9faW5wdXRcIik7XHJcbiAgICAgICAgcmVmcmVzaEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9Eb1dvcmtzX19idG5cIik7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICAgIGxldCByZWZyZXNoVGFzayA9IG5ldyBUYXNrKCk7XHJcbiAgICAgICAgICAgIHJlZnJlc2hUYXNrLkdFVChcIlwiKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJlZnJlc2goKTtcclxuXHJcbiAgICAgICAgYWRkRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBvYnJhbmUgZGFuZSB6IERPTTogXCIsIHRpdGxlLnZhbHVlLCBcIiBUZXh0OiBcIiwgdGV4dC52YWx1ZSk7XHJcbiAgICAgICAgICAgIGxldCBuZXdUYXNrID0gbmV3IFRhc2soKTtcclxuICAgICAgICAgICAgbGV0IG5ld0RhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgICAgICBsZXQgZGF0ZSA9IGAke25ld0RhdGUuZ2V0RGF0ZSgpfS4ke25ld0RhdGUuZ2V0TW9udGgoKSArIDF9LiR7bmV3RGF0ZS5nZXRGdWxsWWVhcigpfWA7XHJcbiAgICAgICAgICAgIGxldCB0aW1lID0gYCR7bmV3RGF0ZS5nZXRIb3VycygpfToke25ld0RhdGUuZ2V0TWludXRlcygpfWA7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiIERhdGE6IFwiLCBkYXRlKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJUaW1lOiBcIiwgdGltZSk7XHJcbiAgICAgICAgICAgIGlmIChuZXdUYXNrLnZhbGlkYXRlKHRpdGxlLnZhbHVlLCB0ZXh0LnZhbHVlLCBkYXRlLCB0aW1lKSkge1xyXG4gICAgICAgICAgICAgICAgbmV3VGFzay5QT1NUKCk7XHJcbiAgICAgICAgICAgICAgICB0aXRsZS52YWx1ZSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICB0ZXh0LnZhbHVlID0gXCJcIjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwiV3Bpc3ogcG9wcmF3bmUgZGFuZSFcIik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHNlYXJjaEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgbGV0IHNlYXJjaFRhc2sgPSBuZXcgVGFzaygpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlN6dWthajogXCIsIHNlYXJjaFdvcmQudmFsdWUpO1xyXG4gICAgICAgICAgICBpZiAoc2VhcmNoV29yZC52YWx1ZSAhPT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgc2VhcmNoVGFzay5HRVQoYD9xPSR7c2VhcmNoV29yZC52YWx1ZX1gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJlZnJlc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHJlZnJlc2gpO1xyXG5cclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZWxlbWVudCl7XHJcbiAgICAgICAgICAgIGlmKGVsZW1lbnQudGFyZ2V0LmNsYXNzTmFtZSA9PT0gXCJ0YXNrX19jbGVhbi1idG5cIil7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVzdXdhbSB6YWRhbmllOiBcIixlbGVtZW50LnNyY0VsZW1lbnQuaWQpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGRlbGV0ZVRhc2sgPSBuZXcgVGFzaygpO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlVGFzay5ERUxFVEUoYC8ke2VsZW1lbnQuc3JjRWxlbWVudC5pZH1gKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBUYXNrKCkge1xyXG4gICAgICAgIHRoaXMubXlSZXF1ZXN0ID0gXCJodHRwczovL215LWpzb24tc2VydmVyLnR5cGljb2RlLmNvbS90b21wYWNpb3IvZmFrZVNlcnZlci90b0RvVGFza1wiOyAvL1wiaHR0cDovL2xvY2FsaG9zdDozMDAwL3RvRG9UYXNrXCI7XHJcbiAgICAgICAgdGhpcy5qc29uT2JqZWN0ID0ge1xyXG4gICAgICAgICAgICB0aXRsZTogXCJcIixcclxuICAgICAgICAgICAgdGV4dDogXCJcIixcclxuICAgICAgICAgICAgaWQ6IDAsXHJcbiAgICAgICAgICAgIGRhdGU6IDAsXHJcbiAgICAgICAgICAgIHRpbWU6IDBcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIFRhc2sucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKHRpdGxlLCB0ZXh0LCBkYXRlLCB0aW1lKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJ1cnVjaG9taW9uYSAgVmFsaWRhdGVcIik7XHJcbiAgICAgICAgaWYgKHRpdGxlID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdC50aXRsZSA9IHRpdGxlO1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdC50ZXh0ID0gdGV4dDtcclxuICAgICAgICB0aGlzLmpzb25PYmplY3QuZGF0ZSA9IGRhdGU7XHJcbiAgICAgICAgdGhpcy5qc29uT2JqZWN0LnRpbWUgPSB0aW1lO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIFRhc2sucHJvdG90eXBlLmFkZFRhc2sgPSBmdW5jdGlvbiAoZWxlbSkge1xyXG4gICAgICAgIHRoaXMuanNvbk9iamVjdC50aXRsZSA9IGVsZW0udGl0bGU7XHJcbiAgICAgICAgdGhpcy5qc29uT2JqZWN0LnRleHQgPSBlbGVtLnRleHQ7XHJcbiAgICAgICAgdGhpcy5qc29uT2JqZWN0LmlkID0gZWxlbS5pZDtcclxuICAgICAgICB0aGlzLmpzb25PYmplY3QuZGF0ZSA9IGVsZW0uZGF0ZTtcclxuICAgICAgICB0aGlzLmpzb25PYmplY3QudGltZSA9IGVsZW0udGltZTtcclxuXHJcbiAgICAgICAgLy8vLy8vdGFzayAvLy8vLy8vLy8vL1xyXG4gICAgICAgIGxldCB0YXNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFydGljbGVcIik7XHJcbiAgICAgICAgdGFzay5jbGFzc0xpc3QuYWRkKFwidGFza1wiKTtcclxuICAgICAgICB0YXNrLmlkID0gdGhpcy5qc29uT2JqZWN0LmlkO1xyXG4gICAgICAgIGxldCBoZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIGhlYWRlci5jbGFzc0xpc3QuYWRkKFwidGFza19faGVhZGVyXCIpO1xyXG4gICAgICAgIGxldCB0ZXh0QXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgdGV4dEFyZWEuY2xhc3NMaXN0LmFkZChcInRhc2tfX3RleHRcIik7XHJcbiAgICAgICAgbGV0IGNsZWFyQm90aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgY2xlYXJCb3RoLmNsYXNzTGlzdC5hZGQoXCJ0YXNrX19jbGVhci1ib3RoXCIpO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2codGFzayk7XHJcbiAgICAgICAgdGFzay5hcHBlbmRDaGlsZChoZWFkZXIpO1xyXG4gICAgICAgIHRhc2suYXBwZW5kQ2hpbGQoY2xlYXJCb3RoKTtcclxuICAgICAgICB0YXNrLmFwcGVuZENoaWxkKHRleHRBcmVhKTtcclxuICAgICAgICB0b0RvSXRlbXMuYXBwZW5kQ2hpbGQodGFzayk7XHJcblxyXG4gICAgICAgIC8vLy8vLyB0YXNrIHRpdGxlIC8vLy8vLy8vLy8vXHJcbiAgICAgICAgbGV0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKFwidGFza19fdGl0bGVcIik7XHJcbiAgICAgICAgbGV0IGhlYWQzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgzXCIpO1xyXG4gICAgICAgIGxldCB0aXRsZU5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLmpzb25PYmplY3QudGl0bGUpO1xyXG4gICAgICAgIGhlYWQzLmFwcGVuZENoaWxkKHRpdGxlTm9kZSk7XHJcbiAgICAgICAgdGl0bGUuYXBwZW5kQ2hpbGQoaGVhZDMpO1xyXG5cclxuICAgICAgICAvLy8vL2J1dHRvbiBkZWxldGUgLy8vL1xyXG4gICAgICAgIGxldCBkZWxldGVUZXh0ID0gXCJVc3XFhFwiO1xyXG4gICAgICAgIGxldCBjbGVhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgY2xlYW4uY2xhc3NMaXN0LmFkZChcInRhc2tfX2NsZWFuXCIpO1xyXG4gICAgICAgIGxldCBjbGVhbl9idG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gICAgICAgIGNsZWFuX2J0bi5jbGFzc0xpc3QuYWRkKFwidGFza19fY2xlYW4tYnRuXCIpO1xyXG4gICAgICAgIGNsZWFuX2J0bi5pZCA9IHRoaXMuanNvbk9iamVjdC5pZDtcclxuICAgICAgICBsZXQgZGVsZXRlTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGRlbGV0ZVRleHQpO1xyXG4gICAgICAgIGNsZWFuX2J0bi5hcHBlbmRDaGlsZChkZWxldGVOb2RlKTtcclxuICAgICAgICBjbGVhbi5hcHBlbmRDaGlsZChjbGVhbl9idG4pO1xyXG5cclxuICAgICAgICAvLy8vLy90YXNrICBEYXRlIGFuZCB0aW1lIC8vLy8vLy8vLy8vL1xyXG4gICAgICAgIGxldCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICBkYXRlLmNsYXNzTGlzdC5hZGQoXCJ0YXNrX19kYXRlXCIpO1xyXG4gICAgICAgIGxldCBkYXRlTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHRoaXMuanNvbk9iamVjdC5kYXRlKTtcclxuICAgICAgICBkYXRlLmFwcGVuZENoaWxkKGRhdGVOb2RlKTtcclxuXHJcbiAgICAgICAgbGV0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHRpbWUuY2xhc3NMaXN0LmFkZChcInRhc2tfX3RpbWVcIik7XHJcbiAgICAgICAgbGV0IHRpbWVOb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5qc29uT2JqZWN0LnRpbWUpO1xyXG4gICAgICAgIHRpbWUuYXBwZW5kQ2hpbGQodGltZU5vZGUpO1xyXG5cclxuICAgICAgICAvLy8vLy8gdGFzayB0ZXh0IC8vLy8vLy8vLy8vXHJcbiAgICAgICAgbGV0IHBhcmFncmFoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIlBcIik7XHJcbiAgICAgICAgbGV0IG5vZGVUZXh0ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5qc29uT2JqZWN0LnRleHQpO1xyXG4gICAgICAgIHBhcmFncmFoLmFwcGVuZENoaWxkKG5vZGVUZXh0KTtcclxuXHJcblxyXG4gICAgICAgIC8vLy8vLy8gQWRkIGFsbCB0byBUYXNrIC8vLy8vLy8vL1xyXG4gICAgICAgIGhlYWRlci5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcbiAgICAgICAgaGVhZGVyLmFwcGVuZENoaWxkKGNsZWFuKTtcclxuICAgICAgICBoZWFkZXIuYXBwZW5kQ2hpbGQodGltZSk7XHJcbiAgICAgICAgaGVhZGVyLmFwcGVuZENoaWxkKGRhdGUpO1xyXG4gICAgICAgIHRleHRBcmVhLmFwcGVuZENoaWxkKHBhcmFncmFoKTtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJGaW5pc2ggdGFzayAtIEFkZFRhc2tcIik7XHJcbiAgICB9O1xyXG4gICAgVGFzay5wcm90b3R5cGUuUE9TVCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmZXRjaCh0aGlzLm15UmVxdWVzdCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICBcIkNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9VVRGLThcIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh0aGlzLmpzb25PYmplY3QpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PntcclxuICAgICAgICAgICAgICAgIGlmKHJlcy5vayl7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXMpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiV2Ugc2VuZDpcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5HRVQoXCJcIik7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOiA0MDQgTm90IEZvdW5kXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvci5zdGF0dXMgPT09IDQwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6IDQwMCBCYWQgUmVxdWVzdCEgSW5jb3JyZWN0IHJlcXVlc3QgdXBzLi4uXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk90aGVyIGVycm9yOiBcIiwgZXJyb3Iuc3RhdHVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVGFzay5wcm90b3R5cGUuREVMRVRFID0gZnVuY3Rpb24gKG51bWJlcikge1xyXG4gICAgICAgIGZldGNoKHRoaXMubXlSZXF1ZXN0ICsgbnVtYmVyLHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcImRlbGV0ZVwiXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzcC5vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwLmpzb24oKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlc3ApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXNwID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVzcG9uZCBEZWxldGU6IFwiLCByZXNwKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuR0VUKFwiXCIpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNDA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvcjogNDA0IE5vdCBGb3VuZFwiKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOiA0MDAgQmFkIFJlcXVlc3QhIEluY29ycmVjdCByZXF1ZXN0IHVwcy4uLlwiKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJPdGhlciBlcnJvcjogXCIsIGVycm9yLnN0YXR1cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFRhc2sucHJvdG90eXBlLkdFVCA9IGZ1bmN0aW9uIChodHRwUmVxdWVzdCkge1xyXG4gICAgICAgIGZldGNoKHRoaXMubXlSZXF1ZXN0ICsgaHR0cFJlcXVlc3QpXHJcbiAgICAgICAgICAgIC50aGVuKHJlc3AgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3Aub2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcC5qc29uKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXNwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlc3BvbmQgR0VUOiBcIiwgcmVzcCk7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAodG9Eb0l0ZW1zLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0b0RvSXRlbXMucmVtb3ZlQ2hpbGQodG9Eb0l0ZW1zLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkVGFzayhyZXNwW2ldKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOiA0MDQgTm90IEZvdW5kXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvci5zdGF0dXMgPT09IDQwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6IDQwMCBCYWQgUmVxdWVzdCEgSW5jb3JyZWN0IHJlcXVlc3QgdXBzLi4uXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk90aGVyIGVycm9yOiBcIiwgZXJyb3Iuc3RhdHVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59KCkpOyJdfQ==
